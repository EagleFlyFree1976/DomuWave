import{u as A}from"./accountStore.js";import{r as b,v as q,f as j,h as G,s as H,l as P,c as V,o as r,a as n,b as l,d as s,i as c,w as u,x as v,e as f,t as y,F as J}from"./app.js";import{s as K,a as O}from"./index5.js";import{_ as Q}from"./Error404.js";import{a as N,b as W}from"./index.js";import{s as X,a as C}from"./index6.js";const Y={key:0},Z={class:"card shadow mb-4"},$={class:"card-body"},ee={class:"container-fluid mt-4"},ae={class:"w-50"},le={class:"flex justify-center mt-4"},oe={class:"row mb-3"},se={class:"col-sm-9"},te={class:"row mb-3"},ie={class:"col-sm-9"},re={class:"row mb-3"},ne={class:"col-sm-9"},ce={class:"row mb-3"},ue={class:"col-sm-9"},de={class:"row mb-3"},me={class:"col-sm-9"},pe={class:"row mb-3"},ve={class:"col-sm-9"},fe={class:"row mb-3"},ye={class:"col-sm-9"},be={key:1},ke={__name:"AccountCreateForm",setup(ge,{expose:I}){var w=b(!1);const d=A();q();const m=j();var o=b({...d.createitem});const g=b(null),_=b([]),S=b([]),D=b(null);console.log("editEntity ",o);const U=({values:i})=>{const e={};return o.value.name||(e.name=[{message:"Il nome è obbligatorio."}]),o.value.accountType==null&&(e.accountType=[{message:"Specificare la tipologia di account"}]),(o.value.openDate==null||isNaN(new Date(o.value.openDate)))&&(e.openDate=[{message:"Il campo data apertura è obbligatorio."}]),o.value.closedDate!=null&&isNaN(new Date(o.value.closedDate))&&(e.closedDate=[{message:"Il campo data chiusura non è corretto!."}]),o.value.currency==null&&(e.currency=[{message:"Specificare la valuta del conto"}]),{errors:e}};console.log("onFormSubmit pre");async function E(){return new Promise(async i=>{D.value?(g.value=i,await D.value.submit()):i(!1)})}const L=async({valid:i})=>{let e=!1;i&&(w.value=!0,console.log("editEntity",o.value),await d.createEntity(o.value),e=!0,w.value=!1),g.value&&(g.value(e),g.value=null)};console.log("onFormSubmit after");async function M(){m.startLoading(),S.value=await m.loadAccountTypes(),m.stopLoading()}G(async()=>{await M(),d.newEntity()});const R=async i=>{console.log("Carico le valute",i.query),_.value=await m.loadCurrencies(i.query),console.log("Ho caricato le valute:",_)};return I({submitForm:E}),H(()=>d.createitem,i=>{i!=null&&(o.value={...d.createitem})},{immediate:!0}),(i,e)=>{const p=P("Message");return r(),V(J,null,[l(d).createitem!=null?(r(),V("div",Y,[s("div",Z,[s("div",$,[s("div",ee,[s("div",ae,[s("div",le,[c(l(W),{ref_key:"formRef",ref:D,resolver:U,onSubmit:L,class:"flex flex-col gap-4 w-full sm:w-56 mt-2 ml-2"},{default:u(t=>{var F,k,z,x,T,h,B;return[s("div",oe,[e[7]||(e[7]=s("label",{for:"accountType",class:"col-sm-3 col-form-label"},"Tipo",-1)),s("div",se,[c(l(K),{name:"accountType",modelValue:l(o).accountType,"onUpdate:modelValue":e[0]||(e[0]=a=>l(o).accountType=a),options:S.value,optionLabel:"description",placeholder:"Seleziona la tipologia di account"},null,8,["modelValue","options"]),(F=t.accountType)!=null&&F.invalid?(r(),v(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:u(()=>{var a;return[f(y((a=t.accountType.error)==null?void 0:a.message),1)]}),_:2},1024)):n("",!0)])]),s("div",te,[e[8]||(e[8]=s("label",{for:"name",class:"col-sm-3 col-form-label"},"Nome",-1)),s("div",ie,[c(l(N),{name:"name",type:"text",placeholder:"Inserisci il nome",fluid:"",modelValue:l(o).name,"onUpdate:modelValue":e[1]||(e[1]=a=>l(o).name=a),class:"form-control"},null,8,["modelValue"]),(k=t.name)!=null&&k.invalid?(r(),v(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:u(()=>{var a;return[f(y((a=t.name.error)==null?void 0:a.message),1)]}),_:2},1024)):n("",!0)])]),s("div",re,[e[9]||(e[9]=s("label",{for:"description",class:"col-sm-3 col-form-label"},"Descrizione",-1)),s("div",ne,[c(l(N),{name:"description",type:"text",placeholder:"Inserisci la descrizione",fluid:"",modelValue:l(o).description,"onUpdate:modelValue":e[2]||(e[2]=a=>l(o).description=a),class:"form-control"},null,8,["modelValue"]),(z=t.description)!=null&&z.invalid?(r(),v(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:u(()=>{var a;return[f(y((a=t.description.error)==null?void 0:a.message),1)]}),_:2},1024)):n("",!0)])]),s("div",ce,[e[10]||(e[10]=s("label",{for:"currency",class:"col-sm-3 col-form-label"},"Valuta",-1)),s("div",ue,[c(l(X),{name:"currency",modelValue:l(o).currency,"onUpdate:modelValue":e[3]||(e[3]=a=>l(o).currency=a),optionLabel:"description",suggestions:_.value,forceSelection:"",fluid:"",minLength:"2",onComplete:R,placeholder:"Seleziona la valuta"},null,8,["modelValue","suggestions"]),(x=t.currency)!=null&&x.invalid?(r(),v(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:u(()=>{var a;return[f(y((a=t.currency.error)==null?void 0:a.message),1)]}),_:2},1024)):n("",!0)])]),s("div",de,[e[11]||(e[11]=s("label",{for:"openDate",class:"col-sm-3 col-form-label"},"Data apertura",-1)),s("div",me,[c(l(C),{name:"openDate",fluid:"",modelValue:l(o).openDate,"onUpdate:modelValue":e[4]||(e[4]=a=>l(o).openDate=a),dateFormat:l(m).options.dateFormat,id:"opendate",placeholder:"Inserisci la data di apertura"},null,8,["modelValue","dateFormat"]),(T=t.openDate)!=null&&T.invalid?(r(),v(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:u(()=>{var a;return[f(y((a=t.openDate.error)==null?void 0:a.message),1)]}),_:2},1024)):n("",!0)])]),s("div",pe,[e[12]||(e[12]=s("label",{for:"closedDate",class:"col-sm-3 col-form-label"},"Data chiusura",-1)),s("div",ve,[c(l(C),{name:"closedDate",fluid:"",modelValue:l(o).closedDate,"onUpdate:modelValue":e[5]||(e[5]=a=>l(o).closedDate=a),dateFormat:l(m).options.dateFormat,id:"closedDate",placeholder:"Inserisci la data di chiusura"},null,8,["modelValue","dateFormat"]),(h=t.closedDate)!=null&&h.invalid?(r(),v(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:u(()=>{var a;return[f(y((a=t.closedDate.error)==null?void 0:a.message),1)]}),_:2},1024)):n("",!0)])]),s("div",fe,[e[13]||(e[13]=s("label",{for:"initialbalance",class:"col-sm-3 col-form-label"},"Saldo iniziale",-1)),s("div",ye,[c(l(O),{modelValue:l(o).initialBalance,"onUpdate:modelValue":e[6]||(e[6]=a=>l(o).initialBalance=a),min:0,step:.01,useGrouping:!0,minFractionDigits:2,maxFractionDigits:2,mode:"currency",currency:l(o).currency!=null&&l(o).currency!=""?l(o).currency.code:"EUR",locale:"it-IT",showButtons:"",class:"w-100"},null,8,["modelValue","currency"]),(B=t.initialBalance)!=null&&B.invalid?(r(),v(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:u(()=>{var a;return[f(y((a=t.type.initialBalance)==null?void 0:a.message),1)]}),_:2},1024)):n("",!0)])])]}),_:1},512)])])])])])])):n("",!0),l(d).createitem==null&&!l(m).loading?(r(),V("div",be,[c(Q,{backaction:/accounts/})])):n("",!0)],64)}}};export{ke as _};
