import{S as g,v as n,U as i,f as h,W as d}from"./app.js";import{a as l}from"./accountApi.js";import{t as u}from"./index4.js";const E=g("accountStore",{state:()=>({accounts:null,createmode:!0,loading:!1,error:null,dashboarddata:null,edititem:null,createitem:null}),actions:{async loadDashboard(e){var o,t;const r=n();this.loading=!0,this.error=null;try{const a=await l.get(`/Accounts/${e}/dashboard`);this.dashboarddata=a.data,console.log("this.dashboarddata",this.dashboarddata)}catch(a){console.log("Error",a),r.setMessages("Non è stato possibile caricare la dashboard dell'account specificato",i.error),this.error=((t=(o=a.response)==null?void 0:o.data)==null?void 0:t.message)||"Errore durante il caricamento dell'account specificato"}finally{this.loading=!1}},async createEntity(e){await this.updateEntity(e)},async updateEntity(e){var t,a;const r=n(),o=h();this.loading=!0,this.error=null;try{let s="/Accounts",c=null;e.id!=0?(s=`${s}/${e.id}`,c=await l.put(s,{currencyId:e.currency.id,name:e.name,description:e.description,initialBalance:e.initialBalance,openDate:u(e.openDate),closedDate:e.closedDate!=null&&e.closedDate!=""?u(e.closedDate):null})):(c=await l.post(s,{accountTypeId:e.accountType.id,currencyId:e.currency.id,name:e.name,description:e.description,initialBalance:e.initialBalance,openDate:u(e.openDate)}),this.edititem={...e},this.edititem.id=c.headers["x-key"],e.id=c.headers["x-key"],this.createmode=!1),await o.loadMenu(),this.edititem={...e},this.createmode=!1,r.addMessage(d.SUCCESS.SAVE,i.success),console.log("this.edititem",this.edititem)}catch(s){s.response!=null?r.setMessages(s.response.data.Errors,i.error):(console.log("Error",s),r.setMessages(d.ERROR.SAVE,i.error)),this.error=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||d.ERROR.SAVE}finally{this.loading=!1}},async newEntity(){this.createitem={book:null,accountType:null,currency:null,isActive:!0,balance:null,openDate:null,closedDate:null,name:"[New}",description:"",id:0}},async edit(e){var o,t;const r=n();this.loading=!0,this.error=null;try{const a=await l.get(`/Accounts/${e}`);this.edititem=a.data,this.createmode=!1,console.log("this.edititem",this.edititem)}catch(a){console.log("Error",a),r.setMessages("Non è stato possibile caricare i dati dell'account",i.error),this.error=((t=(o=a.response)==null?void 0:o.data)==null?void 0:t.message)||"Errore durante il caricamento dei dati dell'account"}finally{this.loading=!1}},async deleteAccount(e){var t,a;const r=n(),o=h();this.loading=!0,this.error=null;try{const s=await l.delete(`/Accounts/${e}`);await this.loadAllAccounts(),await o.loadMenu()}catch(s){console.log("Error",s),r.setMessages(s.response.data.Errors,i.error),s.response!=null?r.setMessages(s.response.data.Errors,i.error):(console.log("Error",s),r.setMessages(d.ERROR.DELETE,i.error)),this.error=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Errore durante il caricamento degli accounts"}finally{this.loading=!1}},async loadAllAccounts(){var r,o;const e=n();this.loading=!0,this.error=null;try{const t=await l.get("/Accounts");this.accounts=t.data}catch(t){console.log("Error",t),e.setMessages("Non è stato possibile caricare gli accounts",i.error),this.error=((o=(r=t.response)==null?void 0:r.data)==null?void 0:o.message)||"Errore durante il caricamento degli accounts"}finally{this.loading=!1}},async loadLookups(){await this.loadAllAccounts()}},computed:{}});export{E as u};
