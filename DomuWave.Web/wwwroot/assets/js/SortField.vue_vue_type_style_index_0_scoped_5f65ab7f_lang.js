import{P as f,v as d,S as n,f as C,U as u}from"./app.js";import{a as l}from"./systemApi.js";import{t as c}from"./index4.js";const v=f("exchangeRateHistoryStore",{state:()=>({exchangeRateHistory:null,pageSize:20,page:1,totalRecords:null,totalPages:null,createmode:!1,loading:!1,error:null,edititem:null,createitem:null,targetDate:null,toCurrencyId:null,sortBy:null,sortAscending:null}),actions:{async createEntity(e){return await this.updateEntity(e)},async updateEntity(e){var s,a;const r=d();C(),this.loading=!0,this.error=null;try{let t="/currencies/exchange",o=null;return e.id!=0?(t=`${t}/${e.id}`,o=await l.put(t,{toCurrencyId:e.toCurrency.id,rate:e.rate,targetDate:c(e.validFrom)})):(o=await l.post(t,{toCurrencyId:e.toCurrency.id,rate:e.rate,targetDate:c(e.validFrom)}),this.edititem.id=o.headers["x-key"],e.id=o.headers["x-key"],this.createmode=!1),this.edititem={...e},this.createmode=!1,r.addMessage(u.SUCCESS.SAVE,n.success),console.log("this.edititem",this.edititem),!0}catch(t){return console.log("Error",t),r.setMessages(t.response.data.Errors,n.error),this.error=((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||u.ERROR.SAVE,!1}finally{this.loading=!1}},async newEntity(){this.createmode=!0,this.edititem={toCurrencyId:{id:null,description:null},rate:null,validFrom:new Date,id:0}},async edit(e){var s,a;const r=d();this.loading=!0,this.error=null;try{const t=await l.get(`/currencies/exchange/${e}`);this.edititem=t.data,this.createmode=!1,console.log("this.edititem",this.edititem)}catch(t){console.log("Error",t),r.setMessages("Non è stato possibile caricare i dati",n.error),this.error=((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Errore durante il caricamento dei dati"}finally{this.loading=!1}},async deleteExchangeRateHistory(e){var s,a;const r=d();this.loading=!0,this.error=null;try{const t=await l.delete(`/currencies/exchange/${e}`);await this.loadAllexchangeRateHistory(this.targetDate,this.toCurrencyId,this.sortBy,this.sortAscending)}catch(t){console.log("Error",t),r.setMessages(t.response.data.Errors,n.error),this.error=((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Errore durante il caricamento dei metodi di pagamento"}finally{this.loading=!1}},async onPageChange(e){this.page=e,await this.loadAllexchangeRateHistory(this.targetDate,this.toCurrencyId,this.sortBy,this.sortAscending)},async filterAllexchangeRateHistory(e,r,s,a){this.page=1,this.pageSize=20,await this.loadAllexchangeRateHistory(e,r,s,a)},async loadAllexchangeRateHistory(e,r,s,a){var h,g;const t=d();this.loading=!0,this.error=null;try{this.targetDate=e,this.toCurrencyId=r,this.sortBy=s,this.sortAscending=a;var o=this.targetDate?c(this.targetDate):"",m=this.toCurrencyId?this.toCurrencyId:"",p=this.page?this.page:1,y=this.pageSize?this.pageSize:20,S=this.sortBy?this.sortBy:"",E=this.sortAscending?this.sortAscending=="asc":!0;const i=await l.get(`/currencies/exchange?targetDate=${o}&toCurrencyId=${m}&page=${p}&pageSize=${y}&sortBy=${S}&asc=${E}`);this.exchangeRateHistory=i.data.items,this.pageSize=i.data.pageSize,this.page=i.data.pageNumber,this.totalRecords=i.data.totalCount,this.totalPages=i.data.totalPages}catch(i){console.log("Error",i),t.setMessages("Non è stato possibile caricare i metodi di pagamento",n.error),this.error=((g=(h=i.response)==null?void 0:h.data)==null?void 0:g.message)||"Errore durante il caricamento dei metodi di pagamento"}finally{this.loading=!1}}},computed:{}});export{v as u};
