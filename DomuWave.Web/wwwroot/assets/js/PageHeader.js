import{aA as g,aB as m,ak as l,f as p,aC as c,aD as u,c as y,o as f,d as b,r as h}from"./app.js";const i=g.create({baseURL:"http://localhost:60101/api",timeout:1e4});i.interceptors.request.use(e=>{const t=localStorage.getItem("auth_token"),s=localStorage.getItem("bookId");return t&&(e.headers["X-Auth-Token"]=t),console.log("BOOK G",s),s!=null&&(console.log("Aggiungo book come header: id:",s),e.headers["X-Book-Id"]=s),e});function d(e){if(e instanceof Date||(e=new Date(e)),isNaN(e.getTime()))throw new TypeError("Input must be a valid date or convertible to a valid Date");return new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString()}const A=m("accountStore",{state:()=>({accounts:null,createmode:!0,loading:!1,error:null,dashboarddata:null,edititem:null}),actions:{async loadDashboard(e){var s,a;const t=l();this.loading=!0,this.error=null;try{const o=await i.get(`/Accounts/${e}/dashboard`);this.dashboarddata=o.data,console.log("this.dashboarddata",this.dashboarddata)}catch(o){console.log("Error",o),t.setMessages("Non è stato possibile caricare la dashboard dell'account specificato"),this.error=((a=(s=o.response)==null?void 0:s.data)==null?void 0:a.message)||"Errore durante il caricamento dell'account specificato"}finally{this.loading=!1}},async createEntity(e){await this.updateEntity(e)},async updateEntity(e){var a,o;const t=l(),s=p();this.loading=!0,this.error=null;try{let r="/Accounts",n=null;e.id!=0?(r=`${r}/${e.id}`,n=await i.put(r,{currencyId:e.currency.id,name:e.name,description:e.description,balance:e.balance,openDate:d(e.openDate),closedDate:e.closedDate!=null&&e.closedDate!=""?d(e.closedDate):null})):(n=await i.post(r,{accountTypeId:e.accountType.id,currencyId:e.currency.id,name:e.name,description:e.description,balance:e.balance,openDate:d(e.openDate)}),this.edititem.id=n.headers["x-key"],e.id=n.headers["x-key"],this.createmode=!1),s.loadMenu(),this.edititem={...e},this.createmode=!1,t.addMessage(c.SUCCESS.SAVE,u.success),console.log("this.edititem",this.edititem)}catch(r){console.log("Error",r),t.setMessages(r.response.data.Errors,u.error),this.error=((o=(a=r.response)==null?void 0:a.data)==null?void 0:o.message)||c.ERROR.SAVE}finally{this.loading=!1}},async newEntity(){this.edititem={book:null,accountType:null,currency:null,isActive:!0,balance:null,openDate:null,closedDate:null,name:"[New}",description:"",id:0},this.createmode=!0},async edit(e){var s,a;const t=l();this.loading=!0,this.error=null;try{const o=await i.get(`/Accounts/${e}`);this.edititem=o.data,this.createmode=!1,console.log("this.edititem",this.edititem)}catch(o){console.log("Error",o),t.setMessages("Non è stato possibile caricare i dati dell'account"),this.error=((a=(s=o.response)==null?void 0:s.data)==null?void 0:a.message)||"Errore durante il caricamento dei dati dell'account"}finally{this.loading=!1}},async loadAllAccounts(){var t,s;const e=l();this.loading=!0,this.error=null;try{const a=await i.get("/Accounts");this.accounts=a.data}catch(a){console.log("Error",a),e.setMessages("Non è stato possibile caricare gli accounts"),this.error=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||"Errore durante il caricamento degli accounts"}finally{this.loading=!1}}},computed:{}}),S={class:"d-sm-flex align-items-center justify-content-between mb-4"},E={class:"h3 mb-0 text-gray-800"},k={__name:"PageHeader",props:{},setup(e){return(t,s)=>(f(),y("div",S,[b("h1",E,[h(t.$slots,"default")]),h(t.$slots,"buttons")]))}};export{k as _,A as u};
