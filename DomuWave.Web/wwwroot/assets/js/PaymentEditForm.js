import{al as C,am as I,v as h,an as u,f as z,ao as k,r as y,h as U,s as D,l as T,c as _,o as g,a as v,b as l,d as n,i as b,w as M,x,e as A,t as V,F as j}from"./app.js";import{_ as q}from"./Error404.js";import{a as N}from"./index.js";import{s as G}from"./index4.js";const p=C.create({baseURL:"http://localhost:60101/api",timeout:1e4});p.interceptors.request.use(s=>{const o=localStorage.getItem("auth_token");return o&&(s.headers["X-Auth-Token"]=o),s});const L=I("paymentMethodStore",{state:()=>({paymentmethods:null,createmode:!1,loading:!1,error:null,edititem:null,createitem:null}),actions:{async loadDashboard(s){var a,e;const o=h();this.loading=!0,this.error=null;try{const t=await accountApi.get(`/Accounts/${s}/dashboard`);this.dashboarddata=t.data,console.log("this.dashboarddata",this.dashboarddata)}catch(t){console.log("Error",t),o.setMessages("Non è stato possibile caricare la dashboard dell'account specificato",u.error),this.error=((e=(a=t.response)==null?void 0:a.data)==null?void 0:e.message)||"Errore durante il caricamento dell'account specificato"}finally{this.loading=!1}},async createEntity(s){await this.updateEntity(s)},async updateEntity(s){var e,t;const o=h(),a=z();this.loading=!0,this.error=null;try{let r="/Admin/PaymentMethods",d=null;s.id!=0?(r=`${r}/${s.id}`,d=await p.put(r,{name:s.name,description:s.description})):(d=await p.post(r,{name:s.name,description:s.description}),this.edititem.id=d.headers["x-key"],s.id=d.headers["x-key"],this.createmode=!1),a.loadMenu(),this.edititem={...s},this.createmode=!1,o.addMessage(k.SUCCESS.SAVE,u.success),console.log("this.edititem",this.edititem)}catch(r){console.log("Error",r),o.setMessages(r.response.data.Errors,u.error),this.error=((t=(e=r.response)==null?void 0:e.data)==null?void 0:t.message)||k.ERROR.SAVE}finally{this.loading=!1}},async newEntity(){this.createmode=!0,this.edititem={name:"[New]",description:"",id:0}},async edit(s){var a,e;const o=h();this.loading=!0,this.error=null;try{const t=await p.get(`/PaymentMethods/${s}`);this.edititem=t.data,this.createmode=!1,console.log("this.edititem",this.edititem)}catch(t){console.log("Error",t),o.setMessages("Non è stato possibile caricare i dati",u.error),this.error=((e=(a=t.response)==null?void 0:a.data)==null?void 0:e.message)||"Errore durante il caricamento dei dati"}finally{this.loading=!1}},async deletePaymentMethod(s){var a,e;const o=h();this.loading=!0,this.error=null;try{const t=await p.delete(`/PaymentMethods/${s}`);await this.loadAllPaymentMethods()}catch(t){console.log("Error",t),o.setMessages(t.response.data.Errors,u.error),this.error=((e=(a=t.response)==null?void 0:a.data)==null?void 0:e.message)||"Errore durante il caricamento dei metodi di pagamento"}finally{this.loading=!1}},async disablePaymentMethod(s){var a,e;const o=h();this.loading=!0,this.error=null;try{const t=await p.patch(`/PaymentMethods/${s}/disable`);await this.loadAllPaymentMethods()}catch(t){console.log("Error",t),o.setMessages(t.response.data.Errors,u.error),this.error=((e=(a=t.response)==null?void 0:a.data)==null?void 0:e.message)||"Errore durante il caricamento dei metodi di pagamento"}finally{this.loading=!1}},async enablePaymentMethod(s){var a,e;const o=h();this.loading=!0,this.error=null;try{const t=await p.patch(`/PaymentMethods/${s}/enable`);await this.loadAllPaymentMethods()}catch(t){console.log("Error",t),o.setMessages(t.response.data.Errors,u.error),this.error=((e=(a=t.response)==null?void 0:a.data)==null?void 0:e.message)||"Errore durante il caricamento dei metodi di pagamento"}finally{this.loading=!1}},async loadAllPaymentMethods(){var o,a;const s=h();this.loading=!0,this.error=null;try{const e=await p.get("/PaymentMethods");this.paymentmethods=e.data}catch(e){console.log("Error",e),s.setMessages("Non è stato possibile caricare i metodi di pagamento",u.error),this.error=((a=(o=e.response)==null?void 0:o.data)==null?void 0:a.message)||"Errore durante il caricamento dei metodi di pagamento"}finally{this.loading=!1}}},computed:{}}),O={key:0},X={class:"card shadow mb-4"},Y={class:"card-body"},H={class:"container-fluid mt-4"},J={class:"w-50"},K={class:"card flex justify-center mt-4"},Q={class:"row mb-3"},W={class:"col-sm-9"},Z={class:"row mb-3"},ee={class:"col-sm-9"},te={key:1},ie={__name:"PaymentEditForm",setup(s,{expose:o}){var a=y(!1);const e=L();h();const t=z();var r=y({...e.edititem});const d=y(null),E=y(null);console.log("editEntity ",r);const F=({values:c})=>{const i={};return r.value.name||(i.name=[{message:"Il nome è obbligatorio."}]),{errors:i}};console.log("onFormSubmit pre");async function R(){return new Promise(async c=>{E.value?(d.value=c,await E.value.submit(),c(!0)):c(!1)})}const $=async({valid:c})=>{let i=!1;c&&(a.value=!0,console.log("editEntity",r.value),e.createmode?await e.createEntity(r.value):await e.updateEntity(r.value),a.value=!1),d.value&&(d.value(i),d.value=null)};console.log("onFormSubmit after");async function B(){}return U(async()=>{await B()}),o({submitForm:R}),D(()=>e.edititem,c=>{c!=null&&(r.value={...e.edititem})},{immediate:!0}),(c,i)=>{const S=T("Message");return g(),_(j,null,[l(e).edititem!=null?(g(),_("div",O,[n("div",X,[n("div",Y,[n("div",H,[n("div",J,[n("div",K,[b(l(G),{ref_key:"formRef",ref:E,resolver:F,onSubmit:$,class:"flex flex-col gap-4 w-full sm:w-56 mt-2 ml-2"},{default:M(f=>{var w,P;return[n("div",Q,[i[2]||(i[2]=n("label",{for:"name",class:"col-sm-3 col-form-label"},"Nome",-1)),n("div",W,[b(l(N),{name:"name",type:"text",placeholder:"Inserisci il nome",fluid:"",modelValue:l(r).name,"onUpdate:modelValue":i[0]||(i[0]=m=>l(r).name=m),class:"form-control"},null,8,["modelValue"]),(w=f.name)!=null&&w.invalid?(g(),x(S,{key:0,severity:"error",size:"small",variant:"simple"},{default:M(()=>{var m;return[A(V((m=f.name.error)==null?void 0:m.message),1)]}),_:2},1024)):v("",!0)])]),n("div",Z,[i[3]||(i[3]=n("label",{for:"description",class:"col-sm-3 col-form-label"},"Descrizione",-1)),n("div",ee,[b(l(N),{name:"description",type:"text",placeholder:"Inserisci la descrizione",fluid:"",modelValue:l(r).description,"onUpdate:modelValue":i[1]||(i[1]=m=>l(r).description=m),class:"form-control"},null,8,["modelValue"]),(P=f.description)!=null&&P.invalid?(g(),x(S,{key:0,severity:"error",size:"small",variant:"simple"},{default:M(()=>{var m;return[A(V((m=f.description.error)==null?void 0:m.message),1)]}),_:2},1024)):v("",!0)])])]}),_:1},512)])])])])])])):v("",!0),l(e).edititem==null&&!l(t).loading?(g(),_("div",te,[b(q,{backaction:/PaymentMethods/})])):v("",!0)],64)}}};export{ie as _,L as u};
